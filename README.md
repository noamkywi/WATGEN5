# Contents:
1. License
2. Introduction
3. Requirements
4. Modes/Folder Structure
5. Inputs/Parameters
6. Running
7. Outputs
8. Demos


1) License-------------------------------------------

This software is free for academic use. Users interested in commercial applications should contact Ian Haworth (ihaworth@usc.edu).

2) Introduction--------------------------------------

The Solvate program is used to predict the positions of waters in emtpy proteins and at protein-ligand interfaces, and to calculate water displacement upon ligand binding. The program takes 3D coordinate files (e.g. .pdb) as inputs, as well a set of parameters, and produces solvated PDB files as well as reports in .txt and .csv files. The program can run in one of 3 modes, as described below, depending upon the nature of the input structures. The current folder structure contains all dependencies except Java and is setup to run out of the box. The program runs through a Graphical User Interface (GUI), accessed through the "Solvate.exe" file. It is advised to not change the folder structure provided.


2) Requirements--------------------------------------

The folder structure provided contains all executables and support files necessary to run Solvate and its subroutines, with the exception of Java. Java must be installed on the user's computer and added to PATH for Solvate to run properly. All other necessary files are included in the 'common' and 'exe' directories. DO NOT REMOVE OR EDIT THE FILES IN THESE DIRECTORIES--it will prevent the program from running properly. If hydrogens are to be added to the structures (discussed below), Open Babel is required. OpenBabel-2.3.2 is included in the provided folder structure, and will run properly from that location. Please ensure that your use complies with the licensing terms available at: http://openbabel.org/wiki/Main_Page

The Solvate program is designed to run on Windows 10. It has not been tested on other operating systems


3. Modes---------------------------------------------

There are 3 possible modes in which Solvate can be run: "From PDB", "Single File", and "Protein + Separate Pose(s)". These are accessed through their respective tabs at the top of the GUI. 

3.1.A. From PDB

The "From PDB" mode is designed to download a structure from the RCSB Protein Data Bank (RCSB.org) and solvate it around an indicated ligand. This mode requires identification of the PDB ID, a ligand of interest, any cofactors to be included, and the respective chain letters of these entities. The program will download the indicated PDB file, and sovlate it based on the provided parameters. This mode can only handle one ligand per run.

3.1.B. Single File

The "Single File" mode behaves very similarly to the "From PDB" mode, except that the user provides a single file containing the protein, ligand, and any cofactors (rather than the file being downloaded from the Protein Data Bank). As such, instead of indicating the PDB ID, the user must indicate the structural coordinate file (.pdb format). This mode can only handle one ligand per run. This mode may be usefule for homology models, for example.

3.1.C. Protein + Separate Pose(s)

The "Protein + Separate Pose(s)" is designed to solvate multiple poses of single ligand, such as those generated by a docking run. This mode takes structural coordinate files as inputs, similar to the "Single File" mode, except that it requires separate files for the protein and the ligand poses. All ligand poses must be contained within a single file, separated by a delimiter. As such, the user must indicate the protein file (containing the protein and any cofactors), the ligand pose file, and the delimiter between ligand poses. The protein file should be in .pdb format. The ligand pose file may be in similar formats that contain the same column scheme as .pdb files, such as the .pdbqt files generated by Autodock Vina (http://vina.scripps.edu/). Make sure to indicate the appropriate filename extension in the GUI.

Note that Sovlate will ignore all lines that do not begin with "ATOM" or "HETATM" when reading in the structural coordinates, so other lines do not need to be removed prior to use. This also means that delimiters cannot start with "ATOM" or "HETATM".

While this mode can accomodate different ligand positions, the ligand must be the same in all poses. Different ligands should be solvated in different runs. Additionally, if the RMSD between different ligand poses is >15 Angstroms, it is advised to use separate runs to solvate these poses.

3.2 Folder Structure

The provided folder structure contains the GUI executable (Solvate.exe), this readme, and and "Inputs" folder. The "Inputs" folder contains the dependency folders (common, exe, OpenBabel-2.3.2), and is where runs will be placed. Demo runs are also provided in this folder, and follow the same structure as their respective modes. 

The "From PDB" mode does not require a run folder in the Inputs directory. It will create a folder using the "Run Name" indicated in the GUI, and will download the respective .pdb file from the Protein Data Bank into that folder.

The "Single File" and "Protein + Separate Pose(s)" modes require a run folder to be created within the "Inputs" directory prior to the run. For "Single File" mode, the .pdb file containing the protein and ligand coordinates must then be placed in this folder. For "Protein + Separate Pose(s)" mode, the protein and ligand poses files must be placed in this folder. This folder and the respective files are then indicated in the GUI.



4. Inputs/Parameters---------------------------------

There are two sets of inputs required to run Solvate: the run files (placed in the folder for the given run) and the run parameters (input in the GUI)

4.1 Input Files

Protein and Ligand structural data is required as inputes for each run. The required files for each mode are described in detail above, and listed here: 

**NOTE: pH appropriate Hydrogens must be added to ligands and cofactors for Solvate to work

4.1.A. From PDB

--No files are required, they will be downloaded from the PDB. 
	*Hydrogens added automatically using Open Babel

4.1.B. Single File

-- ONE .pdb file containing coordinates for both the ligand and the protein
	*Hydrogens may be added by user beforehand, or may be added in Solvate using Open Babel
	
4.1.C. Protein + Separate Pose(s)

-- ONE .pdb file containing coordinates for the protein
-- ONE file containing coordinates for all ligand poses, separated by a delimiter on it's own line. This file must follow the same column scheme as .pdb files.
	*Hydrogens MUST be added by user prior to being input into Solvate

4.2 Run Parameters

Run parameters are entered in the GUI. All text fields are case sensitive. They are listed and described below


Path: The location of the 'Inputs' directory (e.g. C:/Solvate/Inputs). This should auto-detect when the GUI is opened. It may be changed if desired, but needs to point to a folder containing the 'common', 'exe', and 'OpenBabel-2.3.2' folders.

Run Name: The folder of the specific run being conducted. This will be generated de novo for "PDB Mode" (and will overwrite any existing folder of the same name). It needs to be created beforehand for "Single File" and "Protein + Separate Pose(s)" modes as described in Section 3.2. Pointing to an existing directory for these modes will use the indicated input files contained within the folder, and overwrite any other files present.

Protein Name: The name of the protein being solvated. This is used for record keeping purposes only and can be arbitrary.

PDB ID: The PDB ID of the structure intended to be solvated (avaialable in "From PBD" mode only)

Structure File: The name of the .pdb file (including the extension) containing coordinates for both the ligand and the protein (available in "Single File" mode only)

Protein File: The name of the .pdb file (including the extension) containing coordinates for the protein (available in "Protein + Separate Pose(s)" mode only)

Chains: Text field where one or more chains to examine can be input. Separate multiple chains by commas.

Cofactor Residue Names: Residue names for cofactors to be included in the solvation and analysis

Ligand Poses Filename: Points to the file containing ligand poses in "Protein + Separate Pose(s)" mode, extension required. Generated automatically in other modes.

Ligand Residue: Indicates ligand by residue name in input .pdb files (available in "From PBD" and "Single File" modes only)

Delimiter: Indicates delimiter seprating ligand poses. Cannot be "ATOM" or "HETATM". Must be on own line within ligand pose file. Available in "Protein + Separate Pose(s)" mode only.

SMILES String: SMILES string of ligand, optional

Rotatable Bonds: count of rotatable bonds in ligand (optional, must be integer if used)

Molecular Weight: molecular weight of ligand in g/mol (must be number, do not include units)

LogP: Octanol-water partition coefficient of ligand (must be number)

Layers: Number of layers of water to add (must be integer; min = 1; max = 10)

Add Hydrogens: Whether or not hydrogrens need to be added to strucutural files. Must be checked for "From PDB" mode. Optional in "Single File" mode (uncheck if you have added hydrogens). Users must add hydrogens beforehand for "Protein + Separate Pose(s)" mode.


5. Running-------------------------------------------

Once the input files and run parameters are entered appropriately, simply press "Run" at the bottom. The run mode will correspend to the currently selected/visible tab. The GUI will be unresponsive while the program runs in the command prompt (which will be open in a seperate window behind the GUI).


6. Outputs-------------------------------------------

Solvate generates a large amount of output files. Most files are generated to track interim inputs and outputs for troubleshooting and development purposes, and can be safely ignored. The key results files are discussed here. 

6.1 Output Folder Structure

After the run is completed, most results will be contained within seperate folders within the Run Folder. Protein only results will be contained within "Prot_Only", while results for ligand poses with be in the respective "Pose_#" folder. For "From PBD" and "Single File" modes, there will only be one ligand pose, which is in "Pose_1". For "Protein + Separate Pose(s)" mode, each pose gets its own folder. Protein-only solvation information is also copied into the individual pose files.

A "Final_Results" folder is also created which contains copies of the comparison files described below in a single location.

6.2 File outputs

6.2.A .pdb Files

Solvate generates solvated ligand-only, protein-only, and protein-ligand structures in .pdb format. Each of these is available in the respective 'Pose_#' folder, with both a "Final" and an "n_Layers" version available. The only difference between the two file types is whether the individual layers added are identified as individual chains (starting at Q, moving towards Z) or a single chain (W). Note that within the "pose_#" folders only waters within 10 A of the ligand are included in the final outputs (including the proetin-only outputs).

A superimposed protein-only/protein-ligand structure for comparison (also in .pdb format) is also generated for each pose, titled "Pose_#_compare_waters.pdb. In this file, protein-only waters are chain X, while protein-ligand waters are chain Y. When multiple poses are run, all comparison files are copied into the "Final_Results" folder.

The general convention for naming is as follows:
Protein -- Chain: A
Ligand -- Chain: L, Residue: LIG
Cofactor -- Chain: C, Residue: CFX
Water -- Chain: W or Q-Z, Residue: WAT

6.2.B .csv Files

Two types of .csv files are generated: a high-level summary titled "%Run_Name%_Global_Results_Analysis_Compare.csv", and a detailed list of interactions titled "WaterAnalysisCompare.csv".

One "%Run_Name%_Global_Results_Analysis_Compare.csv" file is generated per run and is contained within the Run directory, and contains information for all poses. Each pose has its own "WaterAnalysisCompare.csv", located within the pose folder.

***"%Run_Name%_Global_Results_Analysis_Compare.csv" is the files that contains summary results for the solvation and water displacement of a given structure.

7. Demos---------------------------------------------

Three demos are included with the provided folder, one for each mode:

"From PDB" Mode = 			Demo_Run_PDB
"Single File" Mode = 			Demo_Run_SF
"Protein + Separate Pose(s)" Mode	Demo_Run_MP

Both the necessary files and GUI inputs are pre-loaded. To test out the demos, simply open the GUI, select the appropriate tab, and hit "Run".

The "From PDB" and "Single File" demos solvate the DPPIV-sitagliptin complex from PDB ID 1X70. The "Protein + Separate Pose(s)" demo solvates the results from docking glyburide to SUR1 using Autodock Vina (10 poses).
